# Правила оформления PHP-кода

Данный документ содержит основные правила оформлени PHP-кода, принятые в компании. 

Любой новый код пишется с применением этих правил.

При правках старого кода затронутые участки приводятся в соответствие с документом.
Если есть возможность, исправляется весь файл. При добавлении файл в git вносится комментарий: `note: code rules applied (partially)`.

## Именование

+ Имена классов пишутся в стиле `CamelCase` с первой заглавной буквой
+ Имена функций, методов, свойств и переменных - `camelCase` с первой строчный буквой.
  *Исключеные:* имена методов контроллеров CakePHP, доступных через HTTP, записываются в стиле `under_score`

+ Имена ключей ассоциативных массивов - `under_score`
+ Имена констант - `UPPER_CASE`

Имена приватных методов должны начинаться с двух подчеркиваний, например, `__privateMethod`.

## Компановка кода классов

1. Свойства фреймворка
2. Собственные свойства
3. HTTP-методы
4. Публичные методы
5. Защищенные методы
6. Приватные методы

## Базовое форматирование

### Табуляция

Используется для структурирования кода. Каждый новый вложенный уровень начинается с дополнительной табуляции.
Вложенным уровним считается тело класса, функции, цикла и условия, а также элементы массива, при необходимости
его записи в несколько строк, и операнды длинного выражения, разбитого на строки
(подробнее в разделе "Перенос строк").

**Пример:**

```PHP
class MyClass {

  public $myVar = array(
    'item_one' => 1,
    'item_two' => 2
  );

  public function example($arg) {
    if ($condition) {
      foreach ($arg as $i) {
        print exp($i);
      }
    }
  }
}
```

### Пробелы

Все операторы включая операторы конкатиниции и присваивания выделяится пробелом с обеих сторон.
*Исключение:* оператор отрицания пробелами *не* вы выделяется.

**Пример:**

```PHP
$string = subString1 . subString2;

if (!$condition) {
	$a = $b + $c - ($d / 10 * $i);
}
```

Разрешается выравнивать знаки "равно" в серии присваиваний пробелами по правому краю.

**Пример:**

```PHP
$title        = 'some text';
$orders_count = 5;
$customers    = array ();
```

В списке аргументов ставятся пробелы после запятых.

**Пример:**

```PHP
str_replace(' ', '_', $string);
```

При определении функции перед скобками с аргументами пробел не ставится.

**Пример:**

```PHP
function foo($message) {
    echo $message;
}
```

### Перенос строк

Длинные выражения необходимо разбивать на строки длиной не более 80 символов.

При объявлении массива первый каждый последующий уровень вложенности выделяется дополнительной табуляцией 
(подробнее в разделе "Табуляция").

**Пример**

```PHP
$myArray = array(
	'item_one' => 'Some string',
	'item_two' => array(
		1, 2, 3, 4, 5
	)
	...
);
```

При необходимости записать в несколько строк список аргументов, принимаемый функцией, орматирование кода
производится аналогично объявления массива.

**Пример**

```PHP
$value = someFunction(
	$firstVeryLongNameArgument,
	$secondVeryLongNameArgument
);
```

При необходимости разбиения на строки арифметического, логического или конкатинационного выражения
каждая новая строка должна начинаться с оператора.

**Пример:**

```PHP
$image_aspect_ratio = $this->request->data['Image']['with']
	/ $this->request->data['Image']['height'];
	
if (
	$this->User->save($this->request->data)
	&& $this->request->data['User']['subscribe']
) {
	$this->Mailchimp->add_subscriber($this->request->data);
}

$name = $this->request->data['User’]['first_name'] . ' '
	. $this->request->data['User']['last_name'];
```
